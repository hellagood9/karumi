(this.webpackJsonpkarumi=this.webpackJsonpkarumi||[]).push([[0],{12:function(e,t,a){e.exports={navbar:"styles_navbar__3T34a","nav-right":"styles_nav-right__3BkrF",list:"styles_list__1Vz1E","list-item":"styles_list-item__1PqoM",logo:"styles_logo__2Lopg",btn:"styles_btn__24Ps7"}},16:function(e,t,a){e.exports={btn:"styles_btn__2_nSE","btn-primary":"styles_btn-primary__rdmKU",title:"styles_title__2ADP8",content__inner:"styles_content__inner__118z3",verification:"styles_verification__2QSEg"}},18:function(e,t,a){e.exports=a.p+"static/media/karumi-logo.52432395.png"},22:function(e,t,a){e.exports={container:"styles_container__Fky0R",content:"styles_content__1NEmN"}},31:function(e,t,a){e.exports={wrapper:"styles_wrapper__2e2Zn"}},32:function(e,t,a){e.exports=a(44)},4:function(e,t,a){e.exports={logo:"styles_logo__1BjiG",form:"styles_form__kE0-j","input-row":"styles_input-row__2sGl3","form-control":"styles_form-control__MoK8W",btn:"styles_btn__21Jky","btn-primary":"styles_btn-primary__SvwUc",feedback:"styles_feedback__nYdd1",error:"styles_error__27jN0","has-error":"styles_has-error__1RzNY"}},42:function(e,t,a){},43:function(e,t,a){},44:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(26),s=a.n(c),l=a(5),o=a.n(l),u=a(11),i=a(9),m=function(){var e=Object(u.a)(o.a.mark((function e(t,a){var n,r,c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n={method:"POST",headers:{Accept:"application/json"}},a&&(n.headers["Content-Type"]="application/json",n.body=JSON.stringify(a)),e.next=5,fetch("/.netlify/functions/".concat(t),n);case 5:if(!(r=e.sent).ok){e.next=11;break}return e.next=9,r.json();case 9:return c=e.sent,e.abrupt("return",c);case 11:if(r.ok){e.next=13;break}throw new Error("Something went wrong!");case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(0),console.log(e.t0);case 18:case"end":return e.stop()}}),e,null,[[0,15]])})));return function(t,a){return e.apply(this,arguments)}}(),p=Object(n.createContext)({});function f(e){var t=e.children,a=Object(n.useState)({}),c=Object(i.a)(a,2),s=c[0],l=c[1];Object(n.useEffect)((function(){!function(){var e=localStorage.getItem("jwtToken"),t=e&&JSON.parse(e);l(t)}()}),[]);var f=function(e){l(e),localStorage.setItem("jwtToken",JSON.stringify(e))},b=function(){var e=Object(u.a)(o.a.mark((function e(t){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m("login",t);case 2:if(a=e.sent){e.next=5;break}return e.abrupt("return");case 5:a&&f(a);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),_=function(){var e=Object(u.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m("logout",void 0);case 2:l(null),localStorage.removeItem("jwtToken");case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),d=function(){var e=Object(u.a)(o.a.mark((function e(t){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m("me",t);case 2:a=e.sent,f(a);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement(p.Provider,{value:{user:s,login:b,logout:_,verifyUser:d}},t)}var b=function(){return Object(n.useContext)(p)},_=a(13),d=a(2),E=a(10),v=a.n(E),h=a(27),y=a(18),g=a.n(y),j=a(12),w=a.n(j),O=function(){var e=b(),t=e.user.user,a=e.logout,n=t&&t.username;return r.a.createElement("nav",{className:w.a.navbar},r.a.createElement("div",{className:w.a["nav-left"]},r.a.createElement("div",{className:w.a.logo},r.a.createElement(_.b,{to:"/"},r.a.createElement("img",{src:g.a,alt:"Karumi's logo"})))),r.a.createElement("div",{className:w.a["nav-right"]},r.a.createElement("ul",{className:w.a.list},r.a.createElement("li",{"data-testid":"value",className:w.a["list-item"]},n),r.a.createElement("li",null,r.a.createElement("button",{className:w.a.btn,onClick:a},"Logout")))))},N=function(){return r.a.createElement("div",null,"Karumi @ 2020")},k=a(22),S=a.n(k),x=function(e){var t=e.children,a=e.title,n=e.description;return r.a.createElement("div",{className:S.a.container},r.a.createElement(h.a,null,r.a.createElement("title",null,a),r.a.createElement("meta",{name:"description",content:n})),r.a.createElement(O,null),r.a.createElement("main",{className:S.a.content},t),r.a.createElement(N,null))},T=a(16),C=a.n(T),J=function(){var e=b(),t=e.user.user,a=e.logout,c=Object(n.useState)(),s=Object(i.a)(c,2),l=s[0],m=s[1],p=Object(n.useState)(!1),f=Object(i.a)(p,2),_=f[0],d=f[1],E=t&&t.name;Object(n.useEffect)((function(){!function(){var e=localStorage.getItem("jwtToken");if(e){var t=JSON.parse(e);m(t.jwtoken)}}()}),[]);var h=function(){var e=Object(u.a)(o.a.mark((function e(){var t,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={method:"POST",headers:{Accept:"application/json"},body:JSON.stringify(l)},e.next=3,fetch("/.netlify/functions/me",t);case 3:(n=e.sent).ok?(d(!0),m(l)):401===n.status&&a();case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return r.a.createElement(x,{title:"Welcome to Karumi",description:"Karumi's technical challenge"},r.a.createElement("div",{className:C.a.content__inner},r.a.createElement("h1",{className:C.a.title},"Private Area"),r.a.createElement("h2",null,"Hello, ",E),r.a.createElement("button",{onClick:h,className:v()(C.a.btn,C.a["btn-primary"])},"Verify user"),_&&r.a.createElement("p",{className:C.a.verification},"User OK: ".concat(l.slice(0,40),"..."))))},K=function(){var e=Object(d.g)();return r.a.createElement("div",null,r.a.createElement("h3",null,"No match for ",r.a.createElement("code",null,e.pathname)))},P=function(){return r.a.createElement(d.d,null,r.a.createElement(d.b,{exact:!0,path:"/"},r.a.createElement(J,null)),r.a.createElement(d.b,{path:"/login"},r.a.createElement(d.a,{to:"/"})),r.a.createElement(d.b,{path:"*"},r.a.createElement(K,null)))},A=a(15),I=a(23),U=a(4),B=a.n(U),R=function(e){var t=e.onSubmit,a={username:"",password:""},c=function(e){var t={};return e.password?e.password.length<6&&(t.password="Min 6 characters"):t.password="Required",e.username?/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$/i.test(e.username)||(t.username="Invalid username (email address)"):t.username="Required",t},s=Object(n.useState)(a),l=Object(i.a)(s,2),o=l[0],u=l[1],m=Object(n.useState)(!1),p=Object(i.a)(m,2),f=p[0],b=p[1],_=Object(n.useState)(!1),d=Object(i.a)(_,2),E=d[0],h=d[1],y=Object(n.useState)(!1),j=Object(i.a)(y,2),w=j[0],O=j[1],N=Object(n.useState)({}),k=Object(i.a)(N,2),S=k[0],x=k[1],T=o.username,C=o.password,J=Object.keys(c({username:T,password:C})).length>0;Object(n.useEffect)((function(){x(c({username:T,password:C})),J||O(!1)}),[J,T,C]);var K=function(e){var t=e.target,a=t.name,n=t.value;u(Object(I.a)(Object(I.a)({},o),{},Object(A.a)({},a,n)))},P=function(){h(!0)};return r.a.createElement("form",{className:B.a.form,onSubmit:function(e){e.preventDefault(),J?O(!0):(b(!0),setTimeout((function(){t({username:T,password:C}),u(a),h(!1),O(!1),b(!1)}),500))}},r.a.createElement("div",{className:B.a.logo},r.a.createElement("img",{src:g.a,alt:"Karumi's logo"})),r.a.createElement("div",{className:B.a["input-row"]},r.a.createElement("input",{type:"email",name:"username",placeholder:"Username",autoComplete:"off",onChange:function(e){return K(e)},onBlur:P,value:T,className:v()(Object(A.a)({},B.a["has-error"],E&&S.username),[B.a["form-control"]])}),E&&r.a.createElement("div",{className:v()(B.a.feedback,B.a.error)},r.a.createElement("small",null,S.username))),r.a.createElement("div",{className:B.a["input-row"]},r.a.createElement("input",{type:"password",name:"password",placeholder:"password",onChange:function(e){return K(e)},onBlur:P,value:C,className:v()(Object(A.a)({},B.a["has-error"],E&&S.password),[B.a["form-control"]])}),E&&r.a.createElement("div",{className:v()(B.a.feedback,B.a.error)},r.a.createElement("small",null,S.password))),w&&r.a.createElement("p",{className:v()(B.a.feedback,B.a.error)},"Username or Password incorrect!"),r.a.createElement("div",{className:B.a["input-row"]},r.a.createElement("button",{type:"submit",disabled:f,className:v()(B.a.btn,B.a["btn-primary"])},f?"Submitting...":"Login")))},Z=a(31),q=a.n(Z),z=function(){var e=b().login;return r.a.createElement("div",{className:q.a.wrapper},r.a.createElement(R,{onSubmit:e}))},L=function(){return r.a.createElement(d.d,null,r.a.createElement(d.b,{exact:!0,path:"/"},r.a.createElement(d.a,{to:"login"})),r.a.createElement(d.b,{path:"/login"},r.a.createElement(z,null)),r.a.createElement(d.b,{path:"*"},r.a.createElement(K,null)))},M=function(){var e=b().user;return r.a.createElement(_.a,null,e?r.a.createElement(P,null):r.a.createElement(L,null))},D=(a(42),a(43),function(){return r.a.createElement(f,null,r.a.createElement(M,null))});s.a.render(r.a.createElement(D,null),document.getElementById("root"))}},[[32,1,2]]]);
//# sourceMappingURL=main.76a2fba6.chunk.js.map